=head1 NAME

fabsys_backup-inject - Inject a volume dump blob into FABS

=head1 SYNOPSIS

B<fabsys backup-inject> [B<--note> <I<note>>] <I<volume>> <I<blob_filepath>>

=head1 DESCRIPTION

The B<fabsys backup-inject> command can be used to inject a volume dump blob
into the FABS backup system.

Normally when a backup is run by fabs (for example, by scheduling with
C<fabsys_backup-start(1)>), fabs generates a volume dump blob by dumping the
volume, and then processes that dump blob and stores it in fabs' database.
But if you already have a dump blob that is generated by some other process,
you may want fabs to re-use that dump blob instead of generating a new
(identical) dump blob again, to avoid hitting the AFS volserver unnecessarily
again. The B<fabsys backup-inject> command can be used to re-use such dump
blobs. Just provide the volume name and full path to a file containing a dump
blob for that volume.

Running this command effectively schedules a backup run, but a backup run that
only backs up the given volume, and only uses the given dump blob instead of
dumping the volume from an AFS volserver. When this command completes, that
backup is just scheduled, and has probably not completed yet. You can examine
progress for it just like a normal backup run, by monitoring
C<fabsys_backup-status(1)>.

While processing the given dump blob, fabs compares the metadata in the dump
blob to the metadata reported by the actual volume it is for. If it looks like
the provided dump blob is out of date, fabs will ignore the dump blob and not
process it. This is because fabs records other volume-related metadata in the
backup database that is not recorded in the dump blob, and so an outdated dump
blob may not be consistent with the other information recorded by fabs.
However, this is just a reasonable effort to avoid consistency issues; other
unavoidable issues are noted in the CONSISTENCY WARNING section below.

=head1 OPTIONS

=over 4

=item B<--note> <I<note>>

This is the same as the B<--note> option to C<fabsys_backup-start(1)>. See
C<fabsys_backup-start(1)> for more information.

=back

=head1 CONSISTENCY WARNING

fabs cannot verify whether or not the dump given to B<fabsys backup-inject> is
correct, since fabs did not generate the dump. That is, while fabs can do
some sanity checks against the metadata in the provided blob, there is no way
to verify, for example, that the actual data in the blob is valid.

So, when using this command, you must trust that the dump blob you are giving
to fabs is correct. If fabs is given incorrect data, the path translation
functionality in fabs could be wrong, and fabs could possibly restore
incorrect data.

=head1 PRIVILEGED REQUIRED

The issuer of this command must be able to read the FABS configuration
(specifically, the database access information), typically in
B</etc/fabs/fabs.yaml.d/>.

=head1 COPYRIGHT

Copyright (c) 2015, Sine Nomine Associates.

See the provided LICENSE file for licensing terms.
